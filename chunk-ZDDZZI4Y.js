import{l as y,s as D}from"./chunk-ZEZBUIIC.js";import{$ as p,D as g,La as A,_ as d,g as S,ga as m,j as k,ka as C,la as I,m as T,s as h,t as U,x as f}from"./chunk-D2MV77EI.js";var w=[{Enum:0,Url:"",SignalrUrl:""},{Name:"\u0627\u0644\u0646\u0633\u062E\u0629 \u0627\u0644\u0644\u0648\u0643\u0627\u0644",Url:"http://localhost:7000",SignalrUrl:"http://localhost:7000/HubSignalR",ClientKey:"Local"},{Name:"\u0627\u0644\u0646\u0633\u062E\u0629 IIS",Url:"",SignalrUrl:"/HubSignalR",ClientKey:"Local"},{Name:"Monster",Url:"https://eabaadalrahmanapi.runasp.net",ClientKey:"Local",SignalrUrl:"https://eabaadalrahmanapi.runasp.net/HubSignalR"}],N=(function(n){return n[n.None=0]="None",n[n.Local=1]="Local",n[n.IIS=2]="IIS",n[n.Monster=3]="Monster",n})(N||{}),$=N.Monster,l={production:!0,UseHash:!1,SystemUpdate:!1,url:w[$].Url,ClientKey:w[$].ClientKey,signalrUrl:w[$].SignalrUrl};var K=(()=>{let i=class i{constructor(){this.Destroyed$=new T}ngOnDestroy(){this.Destroyed$.next(),this.Destroyed$.complete(),this.Destroyed$.unsubscribe(),this.Destroyed$=new T}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();var u=class extends Error{};u.prototype.name="InvalidTokenError";function _(n){return decodeURIComponent(atob(n).replace(/(.)/g,(i,c)=>{let e=c.charCodeAt(0).toString(16).toUpperCase();return e.length<2&&(e="0"+e),"%"+e}))}function x(n){let i=n.replace(/-/g,"+").replace(/_/g,"/");switch(i.length%4){case 0:break;case 2:i+="==";break;case 3:i+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return _(i)}catch{return atob(i)}}function v(n,i){if(typeof n!="string")throw new u("Invalid token specified: must be a string");i||(i={});let c=i.header===!0?0:1,e=n.split(".")[c];if(typeof e!="string")throw new u(`Invalid token specified: missing part #${c+1}`);let t;try{t=x(e)}catch(s){throw new u(`Invalid token specified: invalid base64 for part #${c+1} (${s.message})`)}try{return JSON.parse(t)}catch(s){throw new u(`Invalid token specified: invalid json for part #${c+1} (${s.message})`)}}var Z=(()=>{let i=class i{constructor(e){this.platformId=e,this.ItemCurrentPage=0,this.SelectIsLoading=!1,this.SelectTake=200,this.isLoading=!1,this.DisabledButton=!1,this.Language="ar",this.RowCount=[10,50,100,200],this.environment=l,this._HttpClient=I(D),this._ServiceLifeTime=I(K),this.language()}language(){if(y(this.platformId)){let e=localStorage.getItem("USER_LANGUAGE");return e==null||e==null?this.Language="en":this.Language=e,this.Language}}Upload(e,t,s=!1){return this.isLoading=s,this._HttpClient.post(`${l.url}/${e}`,t,{reportProgress:!0,observe:"events",responseType:"blob"}).pipe(p(this._ServiceLifeTime.Destroyed$))}Download(e,t=!1){return this.isLoading=t,this._HttpClient.get(`${l.url}/${e}`,{reportProgress:!0,observe:"events",responseType:"blob"}).pipe(p(this._ServiceLifeTime.Destroyed$))}get(e,t=!1){return this.isLoading=t,this._HttpClient.get(`${l.url}/${e}`).pipe(p(this._ServiceLifeTime.Destroyed$))}getById(e,t,s=!1){return this.isLoading=s,this._HttpClient.get(`${l.url}/${e}?Id=${t}`).pipe(p(this._ServiceLifeTime.Destroyed$))}post(e,t,s=!1){if(y(this.platformId)){this.isLoading=s;let o=U(t);return t?.TableName&&(o=h(this.encryptTableName(this.SessionKey(),t.TableName)).pipe(f(r=>(t.TableName=r,t)))),t?.OrderByField&&(o=o.pipe(d(r=>h(this.encryptTableName(this.SessionKey(),r.OrderByField)).pipe(f(a=>(r.OrderByField=a,r)))))),t?.JoinTables?.length&&(o=o.pipe(d(r=>g(r.JoinTables.map(a=>h(this.encryptTableName(this.SessionKey(),a)))).pipe(f(a=>(r.JoinTables=a,r)))))),t?.Columns?.length&&(o=o.pipe(d(r=>g(r.Columns.map(a=>h(this.encryptTableName(this.SessionKey(),a)))).pipe(f(a=>(r.Columns=a,r)))))),t?.SearchFields?.length&&(o=o.pipe(d(r=>g(r.SearchFields.map(a=>h(this.encryptTableName(this.SessionKey(),a)))).pipe(f(a=>(r.SearchFields=a,r)))))),t?.JoinConditions?.length&&(o=o.pipe(d(r=>g(r.JoinConditions.map(a=>h(this.encryptTableName(this.SessionKey(),a)))).pipe(f(a=>(r.JoinConditions=a,r)))))),o.pipe(d(r=>this._HttpClient.post(`${l.url}/${e}`,r)),p(this._ServiceLifeTime.Destroyed$))}else return new k}delete(e,t,s=!1){return this.isLoading=s,this._HttpClient.delete(`${l.url}/${e}?Id=${t}`).pipe(p(this._ServiceLifeTime.Destroyed$))}put(e,t,s=!1){return this.isLoading=s,this._HttpClient.put(`${l.url}/${e}`,t).pipe(p(this._ServiceLifeTime.Destroyed$))}SessionKey(){if(y(this.platformId)){let e=localStorage.getItem("AppToken");if(e!=""&&e!=null&&e!=null)try{return v(e).SessionKey}catch{return localStorage.removeItem("AppToken"),!1}}}b64Encode(e){let t="",s=e.byteLength;for(let o=0;o<s;o++)t+=String.fromCharCode(e[o]);return btoa(t)}b64DecodeToUint8Array(e){let t=atob(e),s=t.length,o=new Uint8Array(s);for(let r=0;r<s;r++)o[r]=t.charCodeAt(r);return o}importKeyFromBase64(e){return S(this,null,function*(){let t=this.b64DecodeToUint8Array(e);return yield crypto.subtle.importKey("raw",t,"AES-GCM",!1,["encrypt"])})}encryptTableName(e,t){return S(this,null,function*(){let s=this.b64DecodeToUint8Array(e),o=yield crypto.subtle.importKey("raw",s,"AES-GCM",!1,["encrypt"]),r=crypto.getRandomValues(new Uint8Array(12)),H=new TextEncoder().encode(t),j=yield crypto.subtle.encrypt({name:"AES-GCM",iv:r},o,H),L=new Uint8Array(j),b=new Uint8Array(r.length+L.length);return b.set(r,0),b.set(L,r.length),btoa(String.fromCharCode(...b))})}getToken(){if(y(this.platformId)){let e=localStorage.getItem("AppToken");if(e)return JSON.parse(e);localStorage.removeItem("AppToken")}return null}TokenFromCookies(){if(y(this.platformId)){let e=localStorage.getItem("AppToken");if(e!=""&&e!=null&&e!=null)try{return v(e)}catch{return localStorage.removeItem("AppToken"),!1}}}DontPlay(){setTimeout(()=>{window.location.reload()},250)}ngOnDestroy(){}};i.\u0275fac=function(t){return new(t||i)(C(A))},i.\u0275prov=m({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();export{v as a,l as b,K as c,Z as d};

import{l as y,q as U}from"./chunk-KYBQWAB6.js";import{$ as d,E as m,La as C,aa as p,ga as g,h as T,k as v,ka as L,la as I,n as S,t as h,u as k,y as f}from"./chunk-MVQPZUAI.js";var j=[{Enum:0,Url:""},{Name:"\u0627\u0644\u0646\u0633\u062E\u0629 \u0627\u0644\u0644\u0648\u0643\u0627\u0644",Url:"http://localhost:7000"},{Name:"IIS",Url:"http://localhost:7000"},{Name:"Monster",Url:"https://eabaadalrahmanapi.runasp.net"}],A=(function(o){return o[o.None=0]="None",o[o.Local=1]="Local",o[o.IIS=2]="IIS",o[o.Monster=3]="Monster",o})(A||{}),F=A.Monster,l={production:!0,UseHash:!1,SystemUpdate:!1,url:j[F].Url};var D=(()=>{let i=class i{constructor(){this.Destroyed$=new S}ngOnDestroy(){this.Destroyed$.next(),this.Destroyed$.complete(),this.Destroyed$.unsubscribe(),this.Destroyed$=new S}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();var u=class extends Error{};u.prototype.name="InvalidTokenError";function x(o){return decodeURIComponent(atob(o).replace(/(.)/g,(i,c)=>{let e=c.charCodeAt(0).toString(16).toUpperCase();return e.length<2&&(e="0"+e),"%"+e}))}function H(o){let i=o.replace(/-/g,"+").replace(/_/g,"/");switch(i.length%4){case 0:break;case 2:i+="==";break;case 3:i+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return x(i)}catch{return atob(i)}}function w(o,i){if(typeof o!="string")throw new u("Invalid token specified: must be a string");i||(i={});let c=i.header===!0?0:1,e=o.split(".")[c];if(typeof e!="string")throw new u(`Invalid token specified: missing part #${c+1}`);let t;try{t=H(e)}catch(s){throw new u(`Invalid token specified: invalid base64 for part #${c+1} (${s.message})`)}try{return JSON.parse(t)}catch(s){throw new u(`Invalid token specified: invalid json for part #${c+1} (${s.message})`)}}var Z=(()=>{let i=class i{constructor(e){this.platformId=e,this.ItemCurrentPage=0,this.SelectIsLoading=!1,this.SelectTake=200,this.isLoading=!1,this.DisabledButton=!1,this.Language="ar",this.RowCount=[10,50,100,200],this.environment=l,this._HttpClient=I(U),this._ServiceLifeTime=I(D),this.language()}language(){if(y(this.platformId)){let e=localStorage.getItem("USER_LANGUAGE");return e==null||e==null?this.Language="en":this.Language=e,this.Language}}Upload(e,t,s=!1){return this.isLoading=s,this._HttpClient.post(`${l.url}/${e}`,t,{reportProgress:!0,observe:"events",responseType:"blob"}).pipe(p(this._ServiceLifeTime.Destroyed$))}Download(e,t=!1){return this.isLoading=t,this._HttpClient.get(`${l.url}/${e}`,{reportProgress:!0,observe:"events",responseType:"blob"}).pipe(p(this._ServiceLifeTime.Destroyed$))}get(e,t=!1){return this.isLoading=t,this._HttpClient.get(`${l.url}/${e}`).pipe(p(this._ServiceLifeTime.Destroyed$))}getById(e,t,s=!1){return this.isLoading=s,this._HttpClient.get(`${l.url}/${e}?Id=${t}`).pipe(p(this._ServiceLifeTime.Destroyed$))}post(e,t,s=!1){if(y(this.platformId)){this.isLoading=s;let n=k(t);return t?.TableName&&(n=h(this.encryptTableName(this.SessionKey(),t.TableName)).pipe(f(r=>(t.TableName=r,t)))),t?.OrderByField&&(n=n.pipe(d(r=>h(this.encryptTableName(this.SessionKey(),r.OrderByField)).pipe(f(a=>(r.OrderByField=a,r)))))),t?.JoinTables?.length&&(n=n.pipe(d(r=>m(r.JoinTables.map(a=>h(this.encryptTableName(this.SessionKey(),a)))).pipe(f(a=>(r.JoinTables=a,r)))))),t?.Columns?.length&&(n=n.pipe(d(r=>m(r.Columns.map(a=>h(this.encryptTableName(this.SessionKey(),a)))).pipe(f(a=>(r.Columns=a,r)))))),t?.SearchFields?.length&&(n=n.pipe(d(r=>m(r.SearchFields.map(a=>h(this.encryptTableName(this.SessionKey(),a)))).pipe(f(a=>(r.SearchFields=a,r)))))),t?.JoinConditions?.length&&(n=n.pipe(d(r=>m(r.JoinConditions.map(a=>h(this.encryptTableName(this.SessionKey(),a)))).pipe(f(a=>(r.JoinConditions=a,r)))))),n.pipe(d(r=>this._HttpClient.post(`${l.url}/${e}`,r)),p(this._ServiceLifeTime.Destroyed$))}else return new v}delete(e,t,s=!1){return this.isLoading=s,this._HttpClient.delete(`${l.url}/${e}?Id=${t}`).pipe(p(this._ServiceLifeTime.Destroyed$))}put(e,t,s=!1){return this.isLoading=s,this._HttpClient.put(`${l.url}/${e}`,t).pipe(p(this._ServiceLifeTime.Destroyed$))}SessionKey(){if(y(this.platformId)){let e=localStorage.getItem("AppToken");if(e!=""&&e!=null&&e!=null)try{return w(e).SessionKey}catch{return localStorage.removeItem("AppToken"),!1}}}b64Encode(e){let t="",s=e.byteLength;for(let n=0;n<s;n++)t+=String.fromCharCode(e[n]);return btoa(t)}b64DecodeToUint8Array(e){let t=atob(e),s=t.length,n=new Uint8Array(s);for(let r=0;r<s;r++)n[r]=t.charCodeAt(r);return n}importKeyFromBase64(e){return T(this,null,function*(){let t=this.b64DecodeToUint8Array(e);return yield crypto.subtle.importKey("raw",t,"AES-GCM",!1,["encrypt"])})}encryptTableName(e,t){return T(this,null,function*(){let s=this.b64DecodeToUint8Array(e),n=yield crypto.subtle.importKey("raw",s,"AES-GCM",!1,["encrypt"]),r=crypto.getRandomValues(new Uint8Array(12)),N=new TextEncoder().encode(t),K=yield crypto.subtle.encrypt({name:"AES-GCM",iv:r},n,N),$=new Uint8Array(K),b=new Uint8Array(r.length+$.length);return b.set(r,0),b.set($,r.length),btoa(String.fromCharCode(...b))})}getToken(){if(y(this.platformId)){let e=localStorage.getItem("AppToken");if(e)return JSON.parse(e);localStorage.removeItem("AppToken")}return null}TokenFromCookies(){if(y(this.platformId)){let e=localStorage.getItem("AppToken");if(e!=""&&e!=null&&e!=null)try{return w(e)}catch{return localStorage.removeItem("AppToken"),!1}}}DontPlay(){setTimeout(()=>{window.location.reload()},250)}ngOnDestroy(){}};i.\u0275fac=function(t){return new(t||i)(L(C))},i.\u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"});let o=i;return o})();export{w as a,l as b,D as c,Z as d};
